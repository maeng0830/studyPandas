import numpy as np
import pandas as pd

#  Pandas DataFrame의 사이즈가 큰 경우, 어떻게 화면에 출력 할지 설정
pd.set_option('display.float_format', lambda x: '%.3f' % x)
pd.set_option('display.max_columns', None)

s1 = pd.Series([1, 2, 3, 4, 5])
print(s1)
# 0    1
# 1    2
# 2    3
# 3    4
# 4    5
# dtype: int64

s1.index = ['a', 'b', 'c', 'd', 'e']
print(s1)
# a    1
# b    2
# c    3
# d    4
# e    5
# dtype: int64

s2 = s1.reindex(['a', 'b', 'd', 'c', 'f'])
print(s2)
# a   1.000
# b   2.000
# d   4.000
# c   3.000
# f     NaN
# dtype: float64

s2 = s1.reindex(['a', 'b', 'd', 'c', 'f'], fill_value=999)
print(s2)
# a      1
# b      2
# d      4
# c      3
# f    999
# dtype: int64

# f는 s1의 기존 인덱스보다 뒤의 인덱스로 간주되기 때문에, 기존 인덱스의 마지막 인덱스인 'e' 값을 가지게된다.
# z는 f의 값을 따르게 된다.
s2 = s1.reindex(['a', 'b', 'd', 'c', 'f', 'z'], method='ffill')
print(s2)
# a    1
# b    2
# d    4
# c    3
# f    5
# z    5
# dtype: int64

#####################################################
df1 = pd.DataFrame({'a': [1, 2, 3], 'b': [4, 5, 6], 'c': [7, 8, 9]})
print(df1)
#    a  b  c
# 0  1  4  7
# 1  2  5  8
# 2  3  6  9

df2 = df1.set_index('c')
print(df2)
#    a  b
# c
# 7  1  4
# 8  2  5
# 9  3  6

######################################################
import FinanceDataReader as fdr

df1 = fdr.DataReader('005930', '2018-01-02', '2018-10-30') # 삼성전자
df2 = fdr.DataReader('069500', '2018-01-02', '2018-10-30') # KODEX 200

print(df1)
#              Open   High    Low  Close    Volume  Change
# Date
# 2018-01-02  51380  51400  50780  51020    169485   0.001
# 2018-01-03  52540  52560  51420  51620    200270   0.012
# 2018-01-04  52120  52180  50640  51080    233909  -0.010
# 2018-01-05  51300  52120  51200  52120    189623   0.020
# 2018-01-08  52400  52520  51500  52020    167673  -0.002
# ...           ...    ...    ...    ...       ...     ...
# 2018-10-24  43050  43100  42250  42550  13522825  -0.012
# 2018-10-25  40600  41550  40550  41000  19338170  -0.036
# 2018-10-26  41100  41300  40400  41000  14413864   0.000
# 2018-10-29  40850  41950  40550  41400  14460521   0.010
# 2018-10-30  41400  43000  41000  42350  14205190   0.023
print(df2)
#              Open   High    Low  Close    Volume  Change
# Date
# 2018-01-02  27816  27893  27729  27841   5198616   0.004
# 2018-01-03  27949  28029  27878  27956   7514357   0.004
# 2018-01-04  28111  28125  27728  27739   9238044  -0.008
# 2018-01-05  27803  28106  27803  28116   8416846   0.014
# 2018-01-08  28222  28333  28060  28303   8315003   0.007
# ...           ...    ...    ...    ...       ...     ...
# 2018-10-24  23657  23674  23373  23421  12536985  -0.005
# 2018-10-25  22923  23045  22701  23045  12102879  -0.016
# 2018-10-26  23063  23068  22466  22682   8530148  -0.016
# 2018-10-29  22747  22897  22446  22494   5494131  -0.008
# 2018-10-30  22456  22848  22376  22652   8301711   0.007

print(df2.index)
# dtype='datetime64[ns]'
df2 = df2.drop(index=pd.to_datetime('2018-01-03'))
print(df2.head(5))
# Date
# 2018-01-02  27816  27893  27729  27841  5198616   0.004
# 2018-01-04  28111  28125  27728  27739  9238044  -0.008
# 2018-01-05  27803  28106  27803  28116  8416846   0.014
# 2018-01-08  28222  28333  28060  28303  8315003   0.007
# 2018-01-09  28208  28415  28058  28192  8259861  -0.004

df2 = df2.reindex(df1.index, method='ffill')
print(df2.head(5))
# Date
# 2018-01-02  27816  27893  27729  27841  5198616   0.004
# 2018-01-03  27816  27893  27729  27841  5198616   0.004
# 2018-01-04  28111  28125  27728  27739  9238044  -0.008
# 2018-01-05  27803  28106  27803  28116  8416846   0.014
# 2018-01-08  28222  28333  28060  28303  8315003   0.007
