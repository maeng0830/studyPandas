import numpy as np
import pandas as pd

pd.set_option('display.float_format', lambda x: '%.2f' % x)
df = pd.read_csv('../../my_data/naver_finance/2015_12.csv')

print(df.head(5))
#     ticker   매출액(억원)  영업이익률(%)  순이익률(%)  ...  PBR(배)  PSR(배)     price    price2
# 0    AK홀딩스  28071.48      3.79    -1.33  ...    1.45    0.30  63200.00  56000.00
# 1      BGF  43342.80      4.24     3.53  ...    5.66    1.01  44202.00  42140.00
# 2  BNK금융지주  51740.25     13.46    10.25  ...    0.39    0.43   8420.00   8680.00
# 3      BYC   1821.96     11.60     7.22  ...    1.01    2.12 459500.00 397000.00
# 4       CJ 211667.08      5.79     2.60  ...    2.15    0.40 236684.00 176334.00

print(df.nsmallest(5, 'PBR(배)'))
#       ticker  매출액(억원)  영업이익률(%)  순이익률(%)  ...  PBR(배)  PSR(배)    price   price2
# 286  삼성엔지니어링 64412.51    -22.58   -20.25  ...   -2.83    0.14 14550.00 10300.00
# 103     고려개발  6070.61    -13.14   -19.73  ...   -1.20     NaN 18694.00 12430.00
# 280     삼부토건  4467.50    -16.26  -141.68  ...   -0.18    0.07 20825.00  1058.00
# 203      티탑스  1123.23     -5.78    -7.98  ...    0.06     NaN  1365.00  1115.00
# 591   한국특수형강  2803.03     -7.01   -19.52  ...    0.10    0.01  1195.00  2785.00

print(df.nsmallest(5, 'PBR(배)').nlargest(5, '영업이익률(%)'))
#       ticker  매출액(억원)  영업이익률(%)  순이익률(%)  ...  PBR(배)  PSR(배)    price   price2
# 203      티탑스  1123.23     -5.78    -7.98  ...    0.06     NaN  1365.00  1115.00
# 591   한국특수형강  2803.03     -7.01   -19.52  ...    0.10    0.01  1195.00  2785.00
# 103     고려개발  6070.61    -13.14   -19.73  ...   -1.20     NaN 18694.00 12430.00
# 280     삼부토건  4467.50    -16.26  -141.68  ...   -0.18    0.07 20825.00  1058.00
# 286  삼성엔지니어링 64412.51    -22.58   -20.25  ...   -2.83    0.14 14550.00 10300.00

#####################################################################################################
print(df.sort_values(['순이익률(%)', 'EPS(원)'], ascending=[True, False]))
#       ticker  매출액(억원)  영업이익률(%)  순이익률(%)  ...  PBR(배)  PSR(배)     price    price2
# 473  제이준코스메틱    80.11   -134.06  -193.43  ...    3.86    6.28   9255.00  15957.00
# 534  키위미디어그룹    56.78    -58.56  -172.04  ...    1.84   12.57    897.00   1090.00
# 454     인스코비   163.13    -29.12  -150.45  ...    4.58    6.42   1575.00   1705.00
# 280     삼부토건  4467.50    -16.26  -141.68  ...   -0.18    0.07  20825.00   1058.00
# 226   롯데관광개발   446.68      3.44  -111.70  ...    2.36    7.35   7691.00   6660.00
# ..       ...      ...       ...      ...  ...     ...     ...       ...       ...
# 459    일동홀딩스   383.01    -12.89    55.69  ...    1.82   16.30  24112.00  24686.00
# 201       동양  3926.65      8.95   154.66  ...    0.69    1.69   2770.00   2985.00
# 461     일성신약   617.45      4.19   160.10  ...    0.48    4.93 114500.00 123000.00
# 320       샘표     3.56   -191.60  3923.34  ...    0.80  511.72  24468.00  36750.00
# 490     주연테크      NaN       NaN      NaN  ...    1.91    0.79    878.00   1125.00